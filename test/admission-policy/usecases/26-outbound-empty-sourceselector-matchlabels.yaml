# ------------------------------------------------------------------------------
# EXPECT: DENY
# EXPECT_MSG_CONTAINS: The FaultInjection "fi-outbound-abort" is invalid: spec.actions.meshFaults[0].http.sourceSelector.matchLabels: Invalid value: "null": spec.actions.meshFaults[0].http.sourceSelector.matchLabels in body must be of type obj
# NOTE: Scenario: OUTBOUND empty sourceSelector.matchLabels
# ------------------------------------------------------------------------------
apiVersion: chaos.sghaida.io/v1alpha1
kind: FaultInjection
metadata:
  name: fi-outbound-abort
  namespace: demo
spec:
  blastRadius:
    durationSeconds: 60
    maxTrafficPercent: 10
    scope: namespace
  actions:
    meshFaults:
      -
        name: outbound-abort
        direction: OUTBOUND
        type: HTTP_ABORT
        percent: 10
        http:
          destinationHosts:
            - foo.default.svc.cluster.local
          sourceSelector:
            matchLabels:
          routes:
            -
              match:
                uriExact: /api
          abort:
            httpStatus: 503
